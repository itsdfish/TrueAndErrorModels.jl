<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Predictive Distributions · TrueAndErrorModels</title><meta name="title" content="Predictive Distributions · TrueAndErrorModels"/><meta property="og:title" content="Predictive Distributions · TrueAndErrorModels"/><meta property="twitter:title" content="Predictive Distributions · TrueAndErrorModels"/><meta name="description" content="Documentation for TrueAndErrorModels."/><meta property="og:description" content="Documentation for TrueAndErrorModels."/><meta property="twitter:description" content="Documentation for TrueAndErrorModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="TrueAndErrorModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TrueAndErrorModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Model Overview</a></li><li><a class="tocitem" href="../parameter_estimation/">Bayesian Parameter Estimation</a></li><li><a class="tocitem" href="../bayes_factor/">Bayesian Model Comparison</a></li><li class="is-active"><a class="tocitem" href>Predictive Distributions</a><ul class="internal"><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Generate-Data"><span>Generate Data</span></a></li><li><a class="tocitem" href="#Estimate-the-Parameters"><span>Estimate the Parameters</span></a></li><li><a class="tocitem" href="#Generate-Posterior-Predictive-Model"><span>Generate Posterior Predictive Model</span></a></li><li><a class="tocitem" href="#Generate-Predictive-Distribution"><span>Generate Predictive Distribution</span></a></li><li><a class="tocitem" href="#Plot-Predictive-Distributions"><span>Plot Predictive Distributions</span></a></li></ul></li><li><a class="tocitem" href="../turing_models/">Off-the-shelf Turing Models</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Predictive Distributions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Predictive Distributions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/TrueAndErrorModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/TrueAndErrorModels.jl/blob/main/docs/src/posterior_predictive.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><img src="https://raw.githubusercontent.com/itsdfish/TrueAndErrorModels.jl/gh-pages/dev/assets/logo_readme.png" alt="drawing" width="900"/><h1 id="Bayesian-Parameter-Estimation"><a class="docs-heading-anchor" href="#Bayesian-Parameter-Estimation">Bayesian Parameter Estimation</a><a id="Bayesian-Parameter-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Parameter-Estimation" title="Permalink"></a></h1><p>The purpose of this tutorial is to demonstrate how to generate and plot prior and posterior predictive distributions of a True and Error Theory model (TET; Birnbaum &amp; Quispe-Torreblanca, 2018) using the <a href="https://turinglang.org/">Turing.jl</a> package. </p><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><p>The first step is to load the required packages. You will need to install each package in your local environment in order to run the code locally. We will also set a random number generator so that the results are reproducible.</p><pre><code class="language-julia hljs">using Random
using StatsPlots
using TrueAndErrorModels
using Turing
using TuringUtilities
Random.seed!(6521)</code></pre><h2 id="Generate-Data"><a class="docs-heading-anchor" href="#Generate-Data">Generate Data</a><a id="Generate-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Data" title="Permalink"></a></h2><p>For a description of the decision making task, please see the description in the <a href="https://itsdfish.github.io/TrueAndErrorModels.jl/dev/overview/">model overview</a>. In the code block below, we will create a model object and generate 2 simulated responses from 100 simulated subjects for a total of 200 responses. </p><pre><code class="language-julia hljs">dist = TrueErrorModel(; p = [0.65, .15, .15, .05], ϵ = fill(.10, 4))
data = rand(dist, 200)</code></pre><pre><code class="language-julia hljs">16-element Vector{Int64}:
 88
 12
  8
  4
  ⋮
  2
  2
  4
  7</code></pre><h2 id="Estimate-the-Parameters"><a class="docs-heading-anchor" href="#Estimate-the-Parameters">Estimate the Parameters</a><a id="Estimate-the-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-the-Parameters" title="Permalink"></a></h2><p>In the code block below, we will create a model object for a TET model with 1 error probability parameter. Note that if you develop a custom model, it must return a <code>NamedTuple</code> of parameters in order to generate predictive distributions, as illustrated below. </p><pre><code class="language-julia hljs">model = tet1_model(data)
chains = sample(model, NUTS(1000, 0.65), MCMCThreads(), 1000, 4)</code></pre><h2 id="Generate-Posterior-Predictive-Model"><a class="docs-heading-anchor" href="#Generate-Posterior-Predictive-Model">Generate Posterior Predictive Model</a><a id="Generate-Posterior-Predictive-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Posterior-Predictive-Model" title="Permalink"></a></h2><p>The code block below creates a model for generating a predictive distribution. The inputs for <code>predict_distribution</code> are defined as follows:</p><ul><li><code>TrueAndErrorModel</code>: a model type used for generating simulated data </li><li><code>model</code>: a Turing model with data attached </li><li><code>func</code>: an arbitrary function applied to the simulated data. In this case, the simulated data are     normalized as response probabilities. </li><li><code>n_samples</code>: the number of simulated response per draw from the prior or posterior distribution </li></ul><pre><code class="language-julia hljs">pred_model =
    predict_distribution(TrueErrorModel; model, func = x -&gt; x ./ sum(x), n_samples = 200)</code></pre><h2 id="Generate-Predictive-Distribution"><a class="docs-heading-anchor" href="#Generate-Predictive-Distribution">Generate Predictive Distribution</a><a id="Generate-Predictive-Distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Predictive-Distribution" title="Permalink"></a></h2><p>The next step is to call <code>generated_quantities</code> to sample from the predictive distribution. If you passed <code>Prior()</code> to <code>sample</code> above, a prior predictive distribution will be used. Otherwise, it will generate a posterior predictive distribution. The second line of code combines the four chains for each response pattern. Each row corresponds to a posterior predictive sample, and each column corresponds to a different response pattern. </p><pre><code class="language-julia hljs">post_preds = generated_quantities(pred_model, chains)
post_preds = stack(post_preds, dims = 1)</code></pre><pre><code class="language-julia hljs">4000×16 Matrix{Float64}:
 0.455  0.095  0.065  0.015  0.06   0.08   0.0    0.025  0.055  0.005  0.07   0.015  0.005  0.01   0.02   0.025
 0.44   0.045  0.025  0.01   0.075  0.065  0.0    0.005  0.06   0.0    0.17   0.01   0.005  0.015  0.035  0.04
 0.43   0.06   0.055  0.015  0.045  0.06   0.01   0.015  0.04   0.005  0.135  0.015  0.0    0.02   0.015  0.08
 0.415  0.07   0.09   0.01   0.025  0.08   0.01   0.015  0.05   0.01   0.155  0.02   0.01   0.01   0.01   0.02
 0.41   0.06   0.05   0.005  0.06   0.06   0.005  0.01   0.06   0.015  0.15   0.02   0.01   0.02   0.025  0.04
 0.455  0.06   0.045  0.025  0.03   0.105  0.0    0.0    0.06   0.005  0.1    0.025  0.015  0.01   0.015  0.05
 0.365  0.06   0.07   0.02   0.09   0.065  0.03   0.0    0.04   0.015  0.14   0.025  0.03   0.005  0.01   0.035
 0.39   0.075  0.075  0.005  0.105  0.085  0.01   0.0    0.085  0.005  0.09   0.005  0.01   0.015  0.02   0.025
 0.455  0.055  0.055  0.005  0.045  0.095  0.0    0.01   0.04   0.0    0.165  0.005  0.005  0.025  0.015  0.025
 ⋮                                  ⋮                                  ⋮                                  ⋮
 0.365  0.055  0.06   0.015  0.06   0.125  0.02   0.005  0.045  0.025  0.13   0.01   0.005  0.01   0.01   0.06
 0.455  0.03   0.04   0.01   0.035  0.125  0.015  0.01   0.04   0.015  0.145  0.015  0.01   0.01   0.0    0.045
 0.395  0.11   0.075  0.01   0.03   0.12   0.015  0.025  0.045  0.005  0.08   0.015  0.005  0.035  0.02   0.015
 0.41   0.075  0.045  0.005  0.075  0.12   0.01   0.005  0.03   0.005  0.165  0.01   0.005  0.01   0.015  0.015
 0.395  0.03   0.05   0.03   0.095  0.12   0.015  0.015  0.035  0.02   0.105  0.01   0.015  0.01   0.025  0.03
 0.465  0.055  0.045  0.005  0.04   0.09   0.0    0.0    0.05   0.0    0.14   0.015  0.015  0.02   0.005  0.055
 0.53   0.03   0.025  0.005  0.07   0.07   0.005  0.005  0.035  0.005  0.135  0.005  0.0    0.025  0.015  0.04
 0.425  0.05   0.07   0.015  0.075  0.06   0.0    0.02   0.065  0.005  0.13   0.015  0.01   0.015  0.015  0.03
 0.455  0.045  0.07   0.015  0.05   0.09   0.01   0.015  0.085  0.005  0.09   0.015  0.02   0.005  0.02   0.01</code></pre><h2 id="Plot-Predictive-Distributions"><a class="docs-heading-anchor" href="#Plot-Predictive-Distributions">Plot Predictive Distributions</a><a id="Plot-Predictive-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-Predictive-Distributions" title="Permalink"></a></h2><p>Lastly, we will plot the posterior predictive distributions as violin plots. The first line of code gets a pre-made vector of response category labels. The function <code>violin</code> generates a violin plot and rotates the response category labels by 90 degrees for readability. The final line of code plots the data as black dots. As expected, the data are typically located near the bulk of the posterior predictive density. </p><pre><code class="language-julia hljs">labels = get_response_labels()
violin(
    post_preds,
    xticks = (1:length(labels), labels),
    ylabel = &quot;Response Probability&quot;,
    leg = false,
    grid = false,
    xrotation = 90
)
scatter!(1:16, data ./ sum(data), color = :black)</code></pre><p><img src="../assets/posterior_predictive_distribution.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bayes_factor/">« Bayesian Model Comparison</a><a class="docs-footer-nextpage" href="../turing_models/">Off-the-shelf Turing Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 1 August 2025 09:40">Friday 1 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
